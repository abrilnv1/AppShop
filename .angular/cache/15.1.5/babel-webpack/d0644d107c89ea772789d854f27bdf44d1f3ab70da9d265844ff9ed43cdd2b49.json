{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/store.service\";\nimport * as i2 from \"src/app/services/payment.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction CartComponent_article_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"article\", 6)(1, \"div\", 7)(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 8)(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"div\", 9)(10, \"p\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"div\", 10)(13, \"div\", 11)(14, \"i\", 12);\n    i0.ɵɵlistener(\"click\", function CartComponent_article_1_Template_i_click_14_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const product_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.updateUnits(\"minus\", product_r2.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"span\");\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"i\", 13);\n    i0.ɵɵlistener(\"click\", function CartComponent_article_1_Template_i_click_17_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const product_r2 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.updateUnits(\"add\", product_r2.id));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(18, \"i\", 14);\n    i0.ɵɵlistener(\"click\", function CartComponent_article_1_Template_i_click_18_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const product_r2 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.deleteProduct(product_r2.id));\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const product_r2 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(product_r2.title);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"$ \", product_r2.price, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", product_r2.cantidad, \" uds\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"$ \", ctx_r0.totalProduct(product_r2.price, product_r2.cantidad), \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(product_r2.cantidad);\n  }\n}\nfunction CartComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 15)(1, \"form\", 16);\n    i0.ɵɵlistener(\"submit\", function CartComponent_div_8_Template_form_submit_1_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.submitPaymentInfo());\n    });\n    i0.ɵɵelementStart(2, \"input\", 17);\n    i0.ɵɵlistener(\"ngModelChange\", function CartComponent_div_8_Template_input_ngModelChange_2_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.paymentInfo.name = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"input\", 18);\n    i0.ɵɵlistener(\"ngModelChange\", function CartComponent_div_8_Template_input_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.paymentInfo.phone = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"input\", 19);\n    i0.ɵɵlistener(\"ngModelChange\", function CartComponent_div_8_Template_input_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.paymentInfo.email = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 20);\n    i0.ɵɵtext(6, \"Enviar Informaci\\u00F3n de Pago\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.paymentInfo.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.paymentInfo.phone);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.paymentInfo.email);\n  }\n}\nexport class CartComponent {\n  constructor(storeService, paymentService) {\n    this.storeService = storeService;\n    this.paymentService = paymentService;\n    this.myCart$ = this.storeService.myCart$;\n    this.viewCart = false;\n    this.showPaymentForm = false; // Nuevo estado para mostrar/ocultar el formulario de pago\n    this.paymentInfo = {\n      name: '',\n      email: '',\n      phone: ''\n    };\n  }\n  updateUnits(operation, id) {}\n  totalProduct(price, units) {\n    return price * units;\n  }\n  deleteProduct(id) {}\n  totalCart() {\n    // Asumiendo que `this.storeService.totalCart()` calcula el total y siempre retorna un número.\n    return this.storeService.totalCart();\n  }\n  proceedToPayment() {\n    // Cambio: En lugar de directamente generar el link de pago,\n    // ahora mostramos el formulario de pago para que el usuario pueda introducir información adicional\n    this.showPaymentForm = true;\n  }\n  submitPaymentInfo() {\n    const total = this.totalCart(); // Obtenemos el total del carrito\n    // Aquí, incluimos la información adicional en la solicitud al servicio de pago\n    this.paymentService.createPaymentLink({\n      ...this.paymentInfo,\n      amount: total // Añadimos el total del carrito\n    }).subscribe({\n      next: response => {\n        // Manejar la respuesta, por ejemplo, abriendo el link de pago para el usuario\n        window.open(response.paymentLink, '_blank');\n        this.showPaymentForm = false; // Ocultamos el formulario después de enviar la información\n      },\n\n      error: error => {\n        console.error('Error al crear el link de pago:', error);\n        // Aquí podrías manejar el error, posiblemente mostrando un mensaje al usuario\n      }\n    });\n  }\n}\n\nCartComponent.ɵfac = function CartComponent_Factory(t) {\n  return new (t || CartComponent)(i0.ɵɵdirectiveInject(i1.StoreService), i0.ɵɵdirectiveInject(i2.PaymentService));\n};\nCartComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CartComponent,\n  selectors: [[\"app-cart\"]],\n  decls: 9,\n  vars: 5,\n  consts: [[1, \"productCart-wrapper\"], [\"class\", \"productCart\", 4, \"ngFor\", \"ngForOf\"], [1, \"cartTotal\"], [1, \"cartTotal-total\"], [1, \"proceed-to-payment-btn\", 3, \"click\"], [\"class\", \"form-container\", 4, \"ngIf\"], [1, \"productCart\"], [1, \"productCart-body\"], [1, \"productCart-body-info\"], [1, \"productCart-total\"], [1, \"productCart-buttons\"], [1, \"productCart-buttons-operators\"], [1, \"fa-solid\", \"fa-minus\", 3, \"click\"], [1, \"fa-solid\", \"fa-plus\", 3, \"click\"], [1, \"fa-solid\", \"fa-trash\", 3, \"click\"], [1, \"form-container\"], [3, \"submit\"], [\"type\", \"text\", \"name\", \"name\", \"placeholder\", \"Nombre Completo\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"phone\", \"name\", \"phone\", \"placeholder\", \"N\\u00FAmero telef\\u00F3nico\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"email\", \"name\", \"email\", \"placeholder\", \"Correo Electr\\u00F3nico\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"submit\"]],\n  template: function CartComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, CartComponent_article_1_Template, 19, 5, \"article\", 1);\n      i0.ɵɵpipe(2, \"async\");\n      i0.ɵɵelementStart(3, \"div\", 2)(4, \"p\", 3);\n      i0.ɵɵtext(5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"button\", 4);\n      i0.ɵɵlistener(\"click\", function CartComponent_Template_button_click_6_listener() {\n        return ctx.proceedToPayment();\n      });\n      i0.ɵɵtext(7, \"Proceder al Pago\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(8, CartComponent_div_8_Template, 7, 3, \"div\", 5);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(2, 3, ctx.myCart$));\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate1(\"Total: $ \", ctx.totalCart(), \"\");\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.showPaymentForm);\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm, i3.AsyncPipe],\n  styles: [\"@charset \\\"UTF-8\\\";\\n.productCart-wrapper[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  padding: 1rem;\\n  \\n  \\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .productCart[_ngcontent-%COMP%] {\\n  padding: 1rem;\\n  display: flex;\\n  justify-content: space-around;\\n  align-items: center;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .productCart-body[_ngcontent-%COMP%] {\\n  flex-basis: 50%;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .productCart-total[_ngcontent-%COMP%] {\\n  flex-basis: 20%;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .productCart-buttons[_ngcontent-%COMP%] {\\n  flex-basis: 30%;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .productCart-body-info[_ngcontent-%COMP%] {\\n  display: flex;\\n  gap: 1rem;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .productCart-buttons[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  gap: 2rem;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .productCart-buttons-operators[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  gap: 1rem;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .productCart-buttons-operators[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\n  border: 1px solid lightgrey;\\n  border-radius: 0.5rem;\\n  padding: 0.5rem;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .cartTotal[_ngcontent-%COMP%] {\\n  padding: 1rem;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .cartTotal-total[_ngcontent-%COMP%] {\\n  font-size: 1.2rem;\\n  font-weight: bold;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .cart-btn[_ngcontent-%COMP%] {\\n  width: 50%;\\n  align-self: center;\\n  border: none;\\n  border-radius: 0.25rem;\\n  margin: 0.75rem 0;\\n  background-color: #030301;\\n  color: white;\\n  cursor: pointer;\\n  padding: 1rem;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n  width: 100%;\\n  max-width: 400px;\\n  \\n  margin: 20px auto;\\n  padding: 20px;\\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\\n  border-radius: 8px;\\n  background-color: #fff;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 10px;\\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .productCart-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n  padding: 10px;\\n  margin: 5px 0;\\n  \\n  border: 1px solid #ccc;\\n  border-radius: 4px;\\n  font-size: 16px;\\n  \\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n  background-color: #ff0033;\\n  color: white;\\n  cursor: pointer;\\n  transition: background-color 0.3s ease;\\n  \\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover {\\n  background-color: #0056b3;\\n  \\n}\\n.productCart-wrapper[_ngcontent-%COMP%]   .proceed-to-payment-btn[_ngcontent-%COMP%] {\\n  align-self: center;\\n  \\n  max-width: 200px;\\n  \\n  font-weight: bold;\\n  \\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9jYXJ0L2NhcnQuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsZ0JBQWdCO0FBQWhCO0VBQ0ksYUFBQTtFQUNBLHNCQUFBO0VBQ0EsdUJBQUE7RUFDQSxhQUFBO0VBb0VBLHlDQUFBO0VBNENBLDREQUFBO0FBNUdKO0FBRkk7RUFDSSxhQUFBO0VBQ0EsYUFBQTtFQUNBLDZCQUFBO0VBQ0EsbUJBQUE7QUFJUjtBQUZRO0VBQ0ksZUFBQTtBQUlaO0FBRFE7RUFDSSxlQUFBO0FBR1o7QUFDUTtFQUNJLGVBQUE7QUFDWjtBQUdRO0VBQ0ksYUFBQTtFQUNBLFNBQUE7QUFEWjtBQUlRO0VBQ0ksYUFBQTtFQUNBLG1CQUFBO0VBQ0EsOEJBQUE7RUFDQSxTQUFBO0FBRlo7QUFJWTtFQUNJLGFBQUE7RUFDQSxtQkFBQTtFQUNBLFNBQUE7QUFGaEI7QUFJZ0I7RUFDSSwyQkFBQTtFQUNBLHFCQUFBO0VBQ0EsZUFBQTtBQUZwQjtBQVFJO0VBQ0ksYUFBQTtBQU5SO0FBUVE7RUFDSSxpQkFBQTtFQUNBLGlCQUFBO0FBTlo7QUFVSTtFQUNJLFVBQUE7RUFDQSxrQkFBQTtFQUNBLFlBQUE7RUFDQSxzQkFBQTtFQUNBLGlCQUFBO0VBQ0EseUJBQUE7RUFDQSxZQUFBO0VBQ0EsZUFBQTtFQUNBLGFBQUE7QUFSUjtBQVlJO0VBQ0ksYUFBQTtFQUNBLHNCQUFBO0VBQ0EsV0FBQTtFQUNBLGdCQUFBO0VBQ0EsMERBQUE7RUFDQSxpQkFBQTtFQUNBLGFBQUE7RUFDQSx3Q0FBQTtFQUNBLGtCQUFBO0VBQ0Esc0JBQUE7QUFWUjtBQWFJO0VBQ0ksYUFBQTtFQUNBLHNCQUFBO0VBQ0EsU0FBQTtBQVhSO0FBY0k7O0VBRUksYUFBQTtFQUNBLGFBQUE7RUFDQSxpREFBQTtFQUNBLHNCQUFBO0VBQ0Esa0JBQUE7RUFDQSxlQUFBO0VBQ0EsaURBQUE7QUFaUjtBQWVJO0VBQ0kseUJBQUE7RUFDQSxZQUFBO0VBQ0EsZUFBQTtFQUNBLHNDQUFBO0VBQ0Esd0NBQUE7QUFiUjtBQWVRO0VBQ0kseUJBQUE7RUFDQSwwQ0FBQTtBQWJaO0FBa0JJO0VBQ0ksa0JBQUE7RUFDQSxxQ0FBQTtFQUNBLGdCQUFBO0VBQ0Esa0RBQUE7RUFDQSxpQkFBQTtFQUNBLHFCQUFBO0FBaEJSIiwic291cmNlc0NvbnRlbnQiOlsiLnByb2R1Y3RDYXJ0LXdyYXBwZXIge1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxuICAgIHBhZGRpbmc6IDFyZW07XHJcblxyXG4gICAgLnByb2R1Y3RDYXJ0IHtcclxuICAgICAgICBwYWRkaW5nOiAxcmVtO1xyXG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XHJcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuXHJcbiAgICAgICAgJi1ib2R5IHtcclxuICAgICAgICAgICAgZmxleC1iYXNpczogNTAlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJi10b3RhbCB7XHJcbiAgICAgICAgICAgIGZsZXgtYmFzaXM6IDIwJTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAmLWJ1dHRvbnMge1xyXG4gICAgICAgICAgICBmbGV4LWJhc2lzOiAzMCU7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJi1ib2R5LWluZm8ge1xyXG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgICAgICAgICBnYXA6IDFyZW07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAmLWJ1dHRvbnMge1xyXG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgICAgICAgICAgIGdhcDogMnJlbTtcclxuXHJcbiAgICAgICAgICAgICYtb3BlcmF0b3JzIHtcclxuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgICAgICAgICAgICAgZ2FwOiAxcmVtO1xyXG5cclxuICAgICAgICAgICAgICAgIHNwYW4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIGxpZ2h0Z3JleTtcclxuICAgICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiAwLjVyZW07XHJcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMC41cmVtO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC5jYXJ0VG90YWwge1xyXG4gICAgICAgIHBhZGRpbmc6IDFyZW07XHJcblxyXG4gICAgICAgICYtdG90YWwge1xyXG4gICAgICAgICAgICBmb250LXNpemU6IDEuMnJlbTtcclxuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC5jYXJ0LWJ0biB7XHJcbiAgICAgICAgd2lkdGg6IDUwJTtcclxuICAgICAgICBhbGlnbi1zZWxmOiBjZW50ZXI7XHJcbiAgICAgICAgYm9yZGVyOiBub25lO1xyXG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDAuMjVyZW07XHJcbiAgICAgICAgbWFyZ2luOiAwLjc1cmVtIDA7XHJcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzAzMDMwMTtcclxuICAgICAgICBjb2xvcjogd2hpdGU7XHJcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xyXG4gICAgICAgIHBhZGRpbmc6IDFyZW07XHJcbiAgICB9XHJcblxyXG4gICAgLyogRXN0aWxvcyBwYXJhIGVsIGZvcm11bGFyaW8geSBib3RvbmVzICovXHJcbiAgICAuZm9ybS1jb250YWluZXIge1xyXG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgICAgICB3aWR0aDogMTAwJTtcclxuICAgICAgICBtYXgtd2lkdGg6IDQwMHB4O1xyXG4gICAgICAgIC8qIEFqdXN0YSBlbCBhbmNobyBtw4PCoXhpbW8gZGVsIGZvcm11bGFyaW8gc2Vnw4PCum4gcHJlZmllcmFzICovXHJcbiAgICAgICAgbWFyZ2luOiAyMHB4IGF1dG87XHJcbiAgICAgICAgcGFkZGluZzogMjBweDtcclxuICAgICAgICBib3gtc2hhZG93OiAwIDRweCA2cHggcmdiYSgwLCAwLCAwLCAwLjEpO1xyXG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmO1xyXG4gICAgfVxyXG5cclxuICAgIGZvcm0ge1xyXG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgICAgICBnYXA6IDEwcHg7XHJcbiAgICB9XHJcblxyXG4gICAgaW5wdXQsXHJcbiAgICBidXR0b24ge1xyXG4gICAgICAgIHBhZGRpbmc6IDEwcHg7XHJcbiAgICAgICAgbWFyZ2luOiA1cHggMDtcclxuICAgICAgICAvKiBFc3BhY2lhZG8gZW50cmUgbG9zIGVsZW1lbnRvcyBkZWwgZm9ybXVsYXJpbyAqL1xyXG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XHJcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gICAgICAgIGZvbnQtc2l6ZTogMTZweDtcclxuICAgICAgICAvKiBUYW1hw4PCsW8gZGUgbGEgZnVlbnRlIHBhcmEgbG9zIGlucHV0IHkgYm90b25lcyAqL1xyXG4gICAgfVxyXG5cclxuICAgIGJ1dHRvbiB7XHJcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmMDAzMztcclxuICAgICAgICBjb2xvcjogd2hpdGU7XHJcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xyXG4gICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4zcyBlYXNlO1xyXG4gICAgICAgIC8qIFRyYW5zaWNpw4PCs24gc3VhdmUgZGVsIGNvbG9yIGRlIGZvbmRvICovXHJcblxyXG4gICAgICAgICY6aG92ZXIge1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA1NmIzO1xyXG4gICAgICAgICAgICAvKiBDb2xvciBjdWFuZG8gZWwgcmF0w4PCs24gcGFzYSBwb3IgZW5jaW1hICovXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qIEVzdGlsb3MgZXNwZWPDg8KtZmljb3MgcGFyYSBlbCBib3TDg8KzbiBkZSAnUHJvY2VkZXIgYWwgUGFnbycgKi9cclxuICAgIC5wcm9jZWVkLXRvLXBheW1lbnQtYnRuIHtcclxuICAgICAgICBhbGlnbi1zZWxmOiBjZW50ZXI7XHJcbiAgICAgICAgLyogQ2VudHJhIGVsIGJvdMODwrNuIGVuIGVsIGNvbnRlbmVkb3IgKi9cclxuICAgICAgICBtYXgtd2lkdGg6IDIwMHB4O1xyXG4gICAgICAgIC8qIEFqdXN0YSBlc3RvIHNlZ8ODwrpuIGVsIHRhbWHDg8KxbyBkZXNlYWRvIGRlbCBib3TDg8KzbiAqL1xyXG4gICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG4gICAgICAgIC8qIFRleHRvIGVuIG5lZ3JpdGEgKi9cclxuICAgIH1cclxuXHJcblxyXG59Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","CartComponent","constructor","storeService","paymentService","myCart$","name","email","phone","updateUnits","operation","id","totalProduct","price","units","deleteProduct","totalCart","proceedToPayment","showPaymentForm","submitPaymentInfo","total","createPaymentLink","paymentInfo","amount","subscribe","next","response","window","open","paymentLink","error","console","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\abril\\Desktop\\angular\\appShop\\src\\app\\components\\cart\\cart.component.html","C:\\Users\\abril\\Desktop\\angular\\appShop\\src\\app\\components\\cart\\cart.component.ts"],"sourcesContent":["<div class=\"productCart-wrapper\">\n  <article class=\"productCart\" *ngFor=\"let product of myCart$ | async\">\n    <div class=\"productCart-body\">\n      <p>{{ product.title }}</p>\n      <div class=\"productCart-body-info\">\n        <p>$ {{ product.price }}</p>\n        <p>{{ product.cantidad }} uds</p>\n      </div>\n    </div>\n    <div class=\"productCart-total\">\n      <p>$ {{ totalProduct(product.price, product.cantidad) }}</p>\n    </div>\n    <div class=\"productCart-buttons\">\n      <div class=\"productCart-buttons-operators\">\n        <i\n          class=\"fa-solid fa-minus\"\n          (click)=\"updateUnits('minus', product.id)\"></i>\n        <span>{{ product.cantidad }}</span>\n        <i\n          class=\"fa-solid fa-plus\"\n          (click)=\"updateUnits('add', product.id)\"></i>\n      </div>\n      <i class=\"fa-solid fa-trash\" (click)=\"deleteProduct(product.id)\"></i>\n    </div>\n  </article>\n  <div class=\"cartTotal\">\n    <p class=\"cartTotal-total\">Total: $ {{ totalCart() }}</p>\n    <button class=\"proceed-to-payment-btn\" (click)=\"proceedToPayment()\">Proceder al Pago</button>\n\n    <div *ngIf=\"showPaymentForm\" class=\"form-container\">\n      <form (submit)=\"submitPaymentInfo()\">\n        <input type=\"text\" [(ngModel)]=\"paymentInfo.name\" name=\"name\" placeholder=\"Nombre Completo\" required>\n        <input type=\"phone\" [(ngModel)]=\"paymentInfo.phone\" name=\"phone\" placeholder=\"Número telefónico\" required>\n        <input type=\"email\" [(ngModel)]=\"paymentInfo.email\" name=\"email\" placeholder=\"Correo Electrónico\" required>\n        <button type=\"submit\">Enviar Información de Pago</button>\n      </form>\n    </div>\n\n\n</div>\n","import { Component } from '@angular/core';\nimport { StoreService } from 'src/app/services/store.service';\nimport { PaymentService } from 'src/app/services/payment.service';\n\n@Component({\n  selector: 'app-cart',\n  templateUrl: './cart.component.html',\n  styleUrls: ['./cart.component.scss']\n})\nexport class CartComponent {\n  myCart$ = this.storeService.myCart$;\n  viewCart: boolean = false;\n  showPaymentForm: boolean = false; // Nuevo estado para mostrar/ocultar el formulario de pago\n  paymentInfo = { // Objeto para recoger la información del formulario de pago\n    name: '',\n    email: '',\n    phone: ''\n  };\n\n  constructor(private storeService: StoreService, private paymentService: PaymentService) { }\n\n  updateUnits(operation: string, id: string) {\n  }\n\n  totalProduct(price: number, units: number): number {\n    return price * units;\n  }\n  \n\n  deleteProduct(id: string): void {\n  }\n\n  totalCart(): number {\n    // Asumiendo que `this.storeService.totalCart()` calcula el total y siempre retorna un número.\n    return this.storeService.totalCart();\n  }\n\n  proceedToPayment(): void {\n    // Cambio: En lugar de directamente generar el link de pago,\n    // ahora mostramos el formulario de pago para que el usuario pueda introducir información adicional\n    this.showPaymentForm = true;\n  }\n\n  submitPaymentInfo(): void {\n    const total = this.totalCart(); // Obtenemos el total del carrito\n\n    // Aquí, incluimos la información adicional en la solicitud al servicio de pago\n    this.paymentService.createPaymentLink({\n      ...this.paymentInfo, // Desestructuramos paymentInfo para incluir name, email, etc.\n      amount: total // Añadimos el total del carrito\n    }).subscribe({\n      next: (response) => {\n        // Manejar la respuesta, por ejemplo, abriendo el link de pago para el usuario\n        window.open(response.paymentLink, '_blank');\n        this.showPaymentForm = false; // Ocultamos el formulario después de enviar la información\n      },\n      error: (error) => {\n        console.error('Error al crear el link de pago:', error);\n        // Aquí podrías manejar el error, posiblemente mostrando un mensaje al usuario\n      }\n    });\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}